<?php

// =============================
// Array dos times importantes
// =============================

$t = 0;
$times[$t]['nome'] = "Time RJT";
$times[$t]['peso'] = 10;
$times[$t]['chars'][0][0]['nome'] = "REYJEDITRAINING";
$times[$t]['chars'][0][0]['zeta'][0] = "Inspirational Presence";
$times[$t]['chars'][1][0]['nome'] = "BB8";
$times[$t]['chars'][1][0]['zeta'][0] = "Roll with the Punches";
$times[$t]['chars'][2][0]['nome'] = "R2D2_LEGENDARY";
$times[$t]['chars'][2][1]['nome'] = "VISASMARR";
$times[$t]['chars'][3][0]['nome'] = "RESISTANCETROOPER";
$times[$t]['chars'][4][0]['nome'] = "REY";
$times[$t]['chars'][4][1]['nome'] = "BARRISSOFFEE";
$times[$t]['chars'][4][1]['zeta'][0] = "Swift Recovery";
$times[$t]['chars'][4][2]['nome'] = "HERMITYODA";
$times[$t]['chars'][4][2]['zeta'][0] = "Strength Flows From the Force";

$t++;
$times[$t]['nome'] = "Time Jedi";
$times[$t]['peso'] = 10;
$times[$t]['chars'][0][0]['nome'] = "GRANDMASTERYODA";
$times[$t]['chars'][0][0]['zeta'][0] = "Battle Meditation";
$times[$t]['chars'][0][0]['zeta'][1] = "Grand Master's Guidance";
$times[$t]['chars'][1][0]['nome'] = "EZRABRIDGERS3";
$times[$t]['chars'][1][0]['zeta'][0] = "Flourish";
$times[$t]['chars'][2][0]['nome'] = "HERMITYODA";
$times[$t]['chars'][2][0]['zeta'][0] = "Strength Flows From the Force";
$times[$t]['chars'][3][0]['nome'] = "VISASMARR";
$times[$t]['chars'][3][0]['zeta'][0] = "Returned to the Light";
$times[$t]['chars'][3][1]['nome'] = "BARRISSOFFEE";
$times[$t]['chars'][3][1]['zeta'][0] = "Swift Recovery";
$times[$t]['chars'][4][0]['nome'] = "QUIGONJINN";
$times[$t]['chars'][4][1]['nome'] = "ANAKINKNIGHT";
$times[$t]['chars'][4][2]['nome'] = "AAYLASECURA";

$t++;
$times[$t]['nome'] = "Troopers";
$times[$t]['peso'] = 2;
$times[$t]['chars'][0][0]['nome'] = "VEERS";
$times[$t]['chars'][0][0]['zeta'][0] = "Aggressive Tactician";
$times[$t]['chars'][1][0]['nome'] = "GRANDADMIRALTHRAWN";
$times[$t]['chars'][2][0]['nome'] = "SHORETROOPER";
$times[$t]['chars'][3][0]['nome'] = "COLONELSTARCK";
$times[$t]['chars'][4][0]['nome'] = "SNOWTROOPER";

$t++;
$times[$t]['nome'] = "Palp";
$times[$t]['peso'] = 2;
$times[$t]['chars'][0][0]['nome'] = "EMPERORPALPATINE";
$times[$t]['chars'][0][0]['zeta'][0] = "Emperor of the Galactic Empire";
$times[$t]['chars'][1][0]['nome'] = "GRANDADMIRALTHRAWN";
$times[$t]['chars'][2][0]['nome'] = "DARTHNIHILUS";
$times[$t]['chars'][3][0]['nome'] = "DARTHSION";
$times[$t]['chars'][3][1]['nome'] = "GRANDMOFFTARKIN";
$times[$t]['chars'][4][0]['nome'] = "VADER";
$times[$t]['chars'][4][1]['nome'] = "SITHTROOPER";

$t++;
$times[$t]['nome'] = "Leia Spam";
$times[$t]['peso'] = 2;
$times[$t]['chars'][0][0]['nome'] = "ADMIRALACKBAR";
$times[$t]['chars'][1][0]['nome'] = "PRINCESSLEIA";
$times[$t]['chars'][2][0]['nome'] = "GENERALKENOBI";
$times[$t]['chars'][3][0]['nome'] = "GRANDADMIRALTHRAWN";
$times[$t]['chars'][3][1]['nome'] = "HERMITYODA";
$times[$t]['chars'][3][1]['zeta'][0] = "Strength Flows From the Force";
$times[$t]['chars'][4][0]['nome'] = "EWOKELDER";
$times[$t]['chars'][4][1]['nome'] = "BARRISSOFFEE";
$times[$t]['chars'][4][1]['zeta'][0] = "Swift Recovery";
$times[$t]['chars'][4][2]['nome'] = "SHORETROOPER";

$t++;
$times[$t]['nome'] = "Beast Mode";
$times[$t]['peso'] = 6;
$times[$t]['chars'][0][0]['nome'] = "BOBAFETT";
$times[$t]['chars'][0][1]['nome'] = "OLDBENKENOBI";
$times[$t]['chars'][1][0]['nome'] = "SABINEWRENS3";
$times[$t]['chars'][1][0]['zeta'][0] = "Demolish";
$times[$t]['chars'][2][0]['nome'] = "GRANDADMIRALTHRAWN";
$times[$t]['chars'][3][0]['nome'] = "WAMPA";
$times[$t]['chars'][4][0]['nome'] = "GENERALKENOBI";

$t++;
$times[$t]['nome'] = "Phoenix";
$times[$t]['peso'] = 1;
$times[$t]['chars'][0][0]['nome'] = "HERASYNDULLAS3";
$times[$t]['chars'][1][0]['nome'] = "EZRABRIDGERS3";
$times[$t]['chars'][1][0]['zeta'][0] = "Flourish";
$times[$t]['chars'][2][0]['nome'] = "SABINEWRENS3";
$times[$t]['chars'][2][0]['zeta'][0] = "Demolish";
$times[$t]['chars'][3][0]['nome'] = "ZEBS3";
$times[$t]['chars'][4][0]['nome'] = "KANANJARRUSS3";
$times[$t]['chars'][4][0]['zeta'][0] = "Total Defense";

$t++;
$times[$t]['nome'] = "Chexmix";
$times[$t]['peso'] = 10;
$times[$t]['chars'][0][0]['nome'] = "COMMANDERLUKESKYWALKER";
$times[$t]['chars'][0][0]['zeta'][0] = "It Binds All Things";
$times[$t]['chars'][0][1]['nome'] = "BOBAFETT";
$times[$t]['chars'][1][0]['nome'] = "HANSOLO";
$times[$t]['chars'][1][0]['zeta'][0] = "Shoots First";
$times[$t]['chars'][1][1]['nome'] = "GREEDO";
$times[$t]['chars'][2][0]['nome'] = "DEATHTROOPER";
$times[$t]['chars'][2][0]['unico']['campo'] = "rarity";
$times[$t]['chars'][2][0]['unico']['max']   = 7;
$times[$t]['chars'][2][0]['unico']['extra'] = "principal";
$times[$t]['chars'][3][0]['nome'] = "CHIRRUTIMWE";
$times[$t]['chars'][3][0]['unico']['campo'] = "rarity";
$times[$t]['chars'][3][0]['unico']['max']   = 7;
//$times[$t]['chars'][3][1]['nome'] = "CT7567";
$times[$t]['chars'][4][0]['nome'] = "PAO";
$times[$t]['chars'][4][0]['unico']['campo'] = "rarity";
$times[$t]['chars'][4][0]['unico']['max']   = 7;
$times[$t]['chars'][4][1]['nome'] = "ANAKINKNIGHT";
$times[$t]['chars'][4][1]['unico']['campo'] = "rarity";
$times[$t]['chars'][4][1]['unico']['max']   = 7;
//$times[$t]['chars'][4][2]['nome'] = "POGGLETHELESSER";

$t++;
$times[$t]['nome'] = "FO";
$times[$t]['peso'] = 2;
$times[$t]['chars'][0][0]['nome'] = "KYLORENUNMASKED";
$times[$t]['chars'][0][0]['zeta'][0] = "Merciless Pursuit";
$times[$t]['chars'][1][0]['nome'] = "FIRSTORDERTROOPER";
$times[$t]['chars'][2][0]['nome'] = "FIRSTORDEROFFICERMALE";
$times[$t]['chars'][3][0]['nome'] = "FIRSTORDEREXECUTIONER";
$times[$t]['chars'][3][1]['nome'] = "FIRSTORDERTIEPILOT";
$times[$t]['chars'][4][0]['nome'] = "FIRSTORDERSPECIALFORCESPILOT";
$times[$t]['chars'][4][1]['nome'] = "PHASMA";
$times[$t]['chars'][4][2]['nome'] = "KYLOREN";

$t++;
$times[$t]['nome'] = "NS";
$times[$t]['peso'] = 6;
$times[$t]['chars'][0][0]['nome'] = "ASAJVENTRESS";
$times[$t]['chars'][0][0]['zeta'][0] = "Nightsister Swiftness";
$times[$t]['chars'][0][0]['zeta'][1] = "Rampage";
$times[$t]['chars'][1][0]['nome'] = "DAKA";
$times[$t]['chars'][1][0]['zeta'][0] = "Serve Again";
$times[$t]['chars'][2][0]['nome'] = "TALIA";
$times[$t]['chars'][3][0]['nome'] = "NIGHTSISTERACOLYTE";
$times[$t]['chars'][3][1]['nome'] = "MOTHERTALZIN";
$times[$t]['chars'][4][0]['nome'] = "NIGHTSISTERINITIATE";
$times[$t]['chars'][4][1]['nome'] = "NIGHTSISTERZOMBIE";
$times[$t]['chars'][4][1]['unico']['campo'] = "rarity";
$times[$t]['chars'][4][1]['unico']['max']   = 7;


// =============================
// Lista de Membros
// =============================
$i = 0;
if ($pg == "bot") {
	$readPlayer = $PDO->query("SELECT DISTINCT `units`.`player`, `units`.`url` 
		FROM `units` 
		JOIN `jogadores` ON `jogadores`.`url` = `units`.`url`
		WHERE (`jogadores`.`discord` LIKE '%".$_GET['discord']."%' OR `units`.`player` LIKE '%".$_GET['discord']."%') AND `units`.`url` != ''
		ORDER BY `units`.`player`");
} else {
	$readPlayer = $PDO->query("SELECT DISTINCT `player`, `url` 
		FROM `units` 
		WHERE `url` != '' 
		ORDER BY `player`");
}

foreach ($readPlayer as $player){
	$i++;
	$rank[$i]['player'] = $player['player'];
	
	$o = 0;

	$readUnit = $PDO->query("SELECT `units`.*, `characters`.`power` as `max_power`
		FROM `units` 
        LEFT JOIN `characters` ON `characters`.`base_id` = `units`.`base_id` 
		WHERE `units`.`player` = '".str_replace("'", "\'", $player['player'])."' 
			AND `units`.`url` = '".$player['url']."'");
	foreach ($readUnit as $unit){
		$o++;
		//$rank[$i][$unit['base_id']] = 5;
		$rank[$i][$unit['base_id']]['gear_level'] = $unit['gear_level'];
		$rank[$i][$unit['base_id']]['level'] = $unit['level'];
		$rank[$i][$unit['base_id']]['rarity'] = $unit['rarity'];
		$rank[$i][$unit['base_id']]['power'] = $unit['power'];
		$rank[$i][$unit['base_id']]['max_power'] = $unit['max_power'];
		$rank[$i][$unit['base_id']]['base_id'] = ($unit['gear_level']/12)+($unit['level']/85)+($unit['rarity']/7);
		$rank[$i][$unit['base_id']]['base_id'] = round($rank[$i][$unit['base_id']]['base_id']*100/3, 5);
		$rank[$i][$unit['base_id']]['jafoi'] = 0;
		if ($unit['rarity'] < 7 ) $rank[$i][$unit['base_id']]['base_id'] = 0;
		//(($unit['gear_level']/12)+($unit['level']/85)+($unit['rarity']/12))100/3;
	}
	
	$rank2[$player['url']] = $rank[$i];
}

// =============================
// Dados dos Chars para Exibição
// =============================
$i = 0;
$readBase = $PDO->query("SELECT DISTINCT `characters`.`name`, `characters`.`base_id`, `characters`.`image`, `jogadores`.`allycode`, `jogadores`.`discord` FROM `units` 
LEFT JOIN `characters` ON `units`.`base_id` = `characters`.`base_id` 
LEFT JOIN `jogadores` ON `units`.`url` = `jogadores`.`url` 
ORDER BY `characters`.`name`");
foreach ($readBase as $base_id){
	$char[$base_id['base_id']]['name'] 	= $base_id['name'];
	$char[$base_id['base_id']]['image'] = $base_id['image'];

	$chars[$i]['name'] 			= $base_id['name'];
	$chars[$i]['base_id'] 		= $base_id['base_id'];
	$chars[$i]['image'] 		= $base_id['image'];
	++$i;
}
?>

